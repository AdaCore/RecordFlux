package Array_Message is

   type Byte is mod 256;
   type Bytes is array of Byte;

   type Array_Member is
      message
         Byte : Byte;
      end message;

   type Test_Array is array of Array_Member;

   type Message_Array is
      message
         Length : Byte
            then Array_Field
               with Size => Length * 8;
         Array_Field : Test_Array;
      end message;

   type Message_Array_And_Refinement is
      message
         Length : Byte
            then Array_Field
               with Size => Length * 8;
         Array_Field : Test_Array
            then Payload
               with Size => 8;
         Payload : Opaque;
      end message;

   for Message_Array_And_Refinement use (Payload => Array_Member);

end Array_Message;
